<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario Autom√°tico</title>
    <link rel="stylesheet" href="calendar.css">
</head>
<body>
    <div class="calendar-container">
        <!-- Header compacto -->
        <div class="calendar-header">
            <h2 id="year-month">Cargando...</h2>
            <div class="controls">
                <button id="pause-btn">Pausar</button>
                <button id="reset-btn">Reiniciar</button>
            </div>
        </div>
        
        <!-- Calendario horizontal de una semana -->
        <div class="week-calendar">
            <div class="week-container">
                <div id="week-days">
                    <!-- Los 7 d√≠as de la semana se generan din√°micamente -->
                </div>
            </div>
        </div>
        
        <!-- Informaci√≥n del estado -->
        <div class="status">
            <div class="status-info">
                <p>üìÖ <span id="current-date-full">Cargando fecha completa...</span></p>
                <p>‚öΩ Club seleccionado: <span id="selected-club">Cargando...</span></p>
                <p>üéÆ Los eventos se muestran en la consola (F12)</p>
            </div>
        </div>

        <!-- Ventana de Noticias -->
        <div class="news-container">
            <h2>Noticias</h2>
            <div id="news-content">
                <!-- Aqu√≠ se mostrar√°n los eventos y videos -->
            </div>
        </div>
    </div>

    <!-- Audio elements (hidden) -->
    <audio id="bg-audio" loop></audio>
    <audio id="button-audio"></audio>

    <!-- Scripts de datos est√°ticos -->
    <script src="../data/nombres.js"></script>
    <script src="../data/clubes.js"></script>
    <script src="../data/lesiones.js"></script>
    <script src="../data/cansancio.js"></script>
    <script src="../data/actitudes.js"></script>

    <!-- Scripts de m√≥dulos -->
    <script src="modules/retiro.js"></script>
    <script src="modules/lesiones-manager.js"></script>

    <!-- Script principal del calendario -->
    <script src="calendar.js"></script>
    
    <script>
        // URLs de audio desde GitHub
        const AUDIO_CONFIG = {
            backgroundMusic: "../audio/background-music.mp3",
            buttonSound: "../audio/button-sound.mp3"
        };
        
        // Mostrar club seleccionado y configurar audio
        document.addEventListener('DOMContentLoaded', () => {
            const clubSeleccionado = localStorage.getItem("selectedClub");
            const clubElement = document.getElementById('selected-club');
            if (clubSeleccionado && clubElement) {
                clubElement.textContent = clubSeleccionado;
            } else if (clubElement) {
                clubElement.textContent = 'No seleccionado';
            }
            
            // Inicializar audio autom√°ticamente
            initializeAudio();
        });
        
        function initializeAudio() {
            const bgAudio = document.getElementById('bg-audio');
            const buttonAudio = document.getElementById('button-audio');
            
            // Configurar m√∫sica de fondo
            bgAudio.src = AUDIO_CONFIG.backgroundMusic;
            bgAudio.volume = 0.2; // Volumen m√°s bajo para m√∫sica de fondo
            
            // Configurar sonido de botones
            buttonAudio.src = AUDIO_CONFIG.buttonSound;
            buttonAudio.volume = 0.4; // Volumen moderado para botones
            
            // Intentar reproducir m√∫sica de fondo autom√°ticamente
            bgAudio.play().catch(e => {
                console.log('üéµ Autoplay bloqueado. Haz clic en cualquier lugar para activar audio.');
                // Activar audio en el primer clic del usuario
                document.addEventListener('click', () => {
                    bgAudio.play().then(() => {
                        console.log('üéµ M√∫sica de fondo activada');
                    }).catch(e => console.log('‚ùå Error reproduciendo m√∫sica:', e));
                }, { once: true });
            });
            
            // Agregar sonido a todos los botones
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', playButtonSound);
            });
            
            // Verificar que los archivos se carguen correctamente
            bgAudio.addEventListener('loadstart', () => console.log('üéµ Cargando m√∫sica de fondo...'));
            bgAudio.addEventListener('canplay', () => console.log('‚úÖ M√∫sica de fondo lista'));
            bgAudio.addEventListener('error', (e) => console.log('‚ùå Error cargando m√∫sica:', e));
            
            buttonAudio.addEventListener('loadstart', () => console.log('üîä Cargando sonido de bot√≥n...'));
            buttonAudio.addEventListener('canplay', () => console.log('‚úÖ Sonido de bot√≥n listo'));
            buttonAudio.addEventListener('error', (e) => console.log('‚ùå Error cargando sonido:', e));
        }
        
        function playButtonSound() {
            const buttonAudio = document.getElementById('button-audio');
            buttonAudio.currentTime = 0; // Reiniciar desde el inicio
            buttonAudio.play().catch(e => console.log('‚ùå Error reproduciendo sonido de bot√≥n:', e));
        }
    </script>
</body>
</html>
